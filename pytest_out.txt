============================= test session starts =============================
platform win32 -- Python 3.13.5, pytest-9.0.2, pluggy-1.6.0 -- D:\Github\Lazy-Trading-Bot\venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: D:\Github\Lazy-Trading-Bot
configfile: pytest.ini
plugins: anyio-4.12.1, asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 67 items

tests/test_agent_unwrap.py::TestTryUnwrapNested::test_flat_valid_response_returns_as_is PASSED [  1%]
tests/test_agent_unwrap.py::TestTryUnwrapNested::test_single_wrapper_unwrap PASSED [  2%]
tests/test_agent_unwrap.py::TestTryUnwrapNested::test_double_nested_unwrap PASSED [  4%]
tests/test_agent_unwrap.py::TestTryUnwrapNested::test_completely_wrong_returns_none PASSED [  5%]
tests/test_agent_unwrap.py::TestTryUnwrapNested::test_empty_dict_returns_none PASSED [  7%]
tests/test_agent_unwrap.py::TestTryUnwrapNested::test_depth_limit_prevents_infinite_recursion PASSED [  8%]
tests/test_agent_unwrap.py::TestUnwrapValidation::test_unwrapped_fundamental_validates PASSED [ 10%]
tests/test_agent_unwrap.py::TestUnwrapValidation::test_unwrapped_sentiment_validates PASSED [ 11%]
tests/test_data_pipeline.py::TestPhase8DBTables::test_all_new_tables_exist PASSED [ 13%]
tests/test_data_pipeline.py::TestPhase8DBTables::test_news_articles_has_source_column PASSED [ 14%]
tests/test_data_pipeline.py::TestPhase8DBTables::test_technicals_has_expanded_columns PASSED [ 16%]
tests/test_data_pipeline.py::TestYouTube24hFilter::test_curated_channels_exist PASSED [ 17%]
tests/test_data_pipeline.py::TestYouTube24hFilter::test_no_truncation_constant PASSED [ 19%]
tests/test_data_pipeline.py::TestYouTube24hFilter::test_full_transcript_stored PASSED [ 20%]
tests/test_data_pipeline.py::TestYouTube24hFilter::test_24h_filter_skips_old_videos PASSED [ 22%]
tests/test_data_pipeline.py::TestYouTubeHistoricalRetrieval::test_insert_and_retrieve_transcripts PASSED [ 23%]
tests/test_data_pipeline.py::TestYouTubeHistoricalRetrieval::test_accumulation_across_runs PASSED [ 25%]
tests/test_data_pipeline.py::TestNewsHistoricalRetrieval::test_insert_and_retrieve_news PASSED [ 26%]
tests/test_data_pipeline.py::TestNewsHistoricalRetrieval::test_news_accumulation PASSED [ 28%]
tests/test_data_pipeline.py::TestAgentContextHistoricalData::test_sentiment_agent_formats_multi_source_news PASSED [ 29%]
tests/test_data_pipeline.py::TestAgentContextHistoricalData::test_sentiment_agent_handles_empty_data PASSED [ 31%]
tests/test_data_pipeline.py::TestRiskComputer::test_instantiation PASSED [ 32%]
tests/test_data_pipeline.py::TestRiskComputer::test_risk_metrics_dataclass PASSED [ 34%]
tests/test_data_pipeline.py::TestFundamentalAgentNewData::test_formats_balance_sheet_data PASSED [ 35%]
tests/test_data_pipeline.py::TestFundamentalAgentNewData::test_formats_analyst_data PASSED [ 37%]
tests/test_data_pipeline.py::TestVTTParsing::test_basic_vtt PASSED       [ 38%]
tests/test_data_pipeline.py::TestVTTParsing::test_dedup_overlapping_segments PASSED [ 40%]
tests/test_data_pipeline.py::TestVTTParsing::test_empty_vtt PASSED       [ 41%]
tests/test_sentiment_validation.py::TestSentimentReportValidation::test_valid_report PASSED [ 43%]
tests/test_sentiment_validation.py::TestSentimentReportValidation::test_clamped_score PASSED [ 44%]
tests/test_sentiment_validation.py::TestSentimentReportValidation::test_invalid_sentiment_enum_defaults_to_neutral PASSED [ 46%]
tests/test_sentiment_validation.py::TestSentimentReportValidation::test_wrong_structure_fails_validation PASSED [ 47%]
tests/test_sentiment_validation.py::TestBaseAgentRescueHelpers::test_get_required_keys PASSED [ 49%]
tests/test_sentiment_validation.py::TestBaseAgentRescueHelpers::test_diagnose_wrong_structure PASSED [ 50%]
tests/test_sentiment_validation.py::TestBaseAgentRescueHelpers::test_diagnose_correct_structure_returns_none PASSED [ 52%]
tests/test_sentiment_validation.py::TestBaseAgentRescueHelpers::test_diagnose_invalid_json_returns_none PASSED [ 53%]
tests/test_sentiment_validation.py::TestBaseAgentRescueHelpers::test_fallback_report PASSED [ 55%]
tests/test_sentiment_validation.py::TestBaseAgentRescueHelpers::test_rescue_prompt_contains_error_info PASSED [ 56%]
tests/test_smoke.py::TestImports::test_config PASSED                     [ 58%]
tests/test_smoke.py::TestImports::test_database PASSED                   [ 59%]
tests/test_smoke.py::TestImports::test_market_data_models PASSED         [ 61%]
tests/test_smoke.py::TestImports::test_agent_report_models PASSED        [ 62%]
tests/test_smoke.py::TestImports::test_decision_model PASSED             [ 64%]
tests/test_smoke.py::TestImports::test_llm_service PASSED                [ 65%]
tests/test_smoke.py::TestImports::test_agents PASSED                     [ 67%]
tests/test_smoke.py::TestImports::test_engine PASSED                     [ 68%]
tests/test_smoke.py::TestImports::test_user_config_exists PASSED         [ 70%]
tests/test_yfinance_live.py::TestLiveDataCollection::test_yfinance_price_history_live PASSED [ 71%]
tests/test_yfinance_live.py::TestLiveDataCollection::test_yfinance_fundamentals_live PASSED [ 73%]
tests/test_yfinance_live.py::TestLiveDataCollection::test_yfinance_financial_history_live PASSED [ 74%]
tests/test_yfinance_live.py::TestLiveDataCollection::test_yfinance_balance_sheet_live PASSED [ 76%]
tests/test_yfinance_live.py::TestLiveDataCollection::test_yfinance_cash_flow_live PASSED [ 77%]
tests/test_yfinance_live.py::TestLiveDataCollection::test_yfinance_analyst_data_live PASSED [ 79%]
tests/test_yfinance_live.py::TestLiveDataCollection::test_google_news_live PASSED [ 80%]
tests/test_youtube_collector.py::TestVTTParsing::test_basic_vtt PASSED   [ 82%]
tests/test_youtube_collector.py::TestVTTParsing::test_dedup_overlapping_segments PASSED [ 83%]
tests/test_youtube_collector.py::TestVTTParsing::test_strips_html_tags PASSED [ 85%]
tests/test_youtube_collector.py::TestVTTParsing::test_empty_vtt PASSED   [ 86%]
tests/test_youtube_collector.py::TestVTTParsing::test_skips_metadata_lines PASSED [ 88%]
tests/test_youtube_collector.py::TestNoTruncation::test_full_transcript_preserved PASSED [ 89%]
tests/test_youtube_collector.py::TestNoTruncation::test_short_transcript_not_modified PASSED [ 91%]
tests/test_youtube_collector.py::TestSearchQueries::test_has_multiple_queries PASSED [ 92%]
tests/test_youtube_collector.py::TestSearchQueries::test_queries_use_ticker_placeholder PASSED [ 94%]
tests/test_youtube_collector.py::TestSearchQueries::test_curated_channels_list PASSED [ 95%]
tests/test_youtube_collector.py::TestGetTranscriptTiering::test_library_first_succeeds PASSED [ 97%]
tests/test_youtube_collector.py::TestGetTranscriptTiering::test_fallback_to_ytdlp PASSED [ 98%]
tests/test_youtube_collector.py::TestGetTranscriptTiering::test_both_fail_returns_empty PASSED [100%]

============================= 67 passed in 7.43s ==============================
